name: Banch up-to-date with target

on: pull_request

jobs:
    compare:
        name: Confirm that the branch is up-to-date with its target

        # We can't currently run benchmarks on PRs from forked repos, because the
        # tachometer action reports results by posting a comment, and we can't post
        # comments without a github token.
        if: github.event.pull_request == null || github.event.pull_request.head.repo.full_name == github.repository
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.base_ref }}

            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}

            - name: Find if target has been merged
              run: |
                  git branch --merged origin/$GITHUB_BASE_REF
